<?xml version="1.0"?>

<!-- KC-137R CFM56 Engine/FADEC -->
<!-- Copyright (c) 2024 Josh Davidson (Octal450) -->
<!-- Tables based off my A320 FADEC, vs 101 not 104 -->

<system name="KC-137R: CFM56">
	
	<property value="22000">fadec/limit/rated-thrust</property>
	
	<channel name="Thrust Limits">
		
		<fcs_function name="fadec/limit/rated-thrust-n1">
			<function>
				<table>
					<independentVar lookup="row">/position/altitude-ft</independentVar>
					<independentVar lookup="column">propulsion/tat-c</independentVar>
					<tableData>
						      -45   -15    15    45    75
						-2000  74.8  79.4  83.8  88.2  92.5
						    0  77.4  82.2  86.7  91.2  95.6
						10000  82.4  85.8  90.2  93.1  96.9
						45000  79.6  83.1  87.9  92.3  96.4
					</tableData>
				</table>
			</function>
		</fcs_function>
		
		<fcs_function name="fadec/limit/milthrust-density"> <!-- Copy of MilThrust table with density effects -->
			<function>
				<table>
					<independentVar lookup="row">velocities/mach</independentVar>
					<independentVar lookup="column">atmosphere/density-altitude</independentVar>
					<tableData>
						    -10000   0       10000   20000   30000   45000   50000
						0.0  1.2600  1.0000  0.7400  0.5640  0.3920  0.2840  0.0000
						0.2  1.1710  0.9740  0.6970  0.5360  0.3850  0.2740  0.0000
						0.4  1.1500  0.9570  0.6920  0.5460  0.3870  0.2670  0.0000
						0.6  1.1810  0.9410  0.7210  0.5660  0.3580  0.2310  0.0000
						0.8  1.2290  1.0200  0.7820  0.5570  0.3040  0.2060  0.0000
						0.9  1.2580  1.0200  0.7820  0.5220  0.2710  0.1270  0.0000
						1.0  1.1810  0.9510  0.7210  0.4410  0.1740  0.0580  0.0000
						1.2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
						1.4  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
					</tableData>
				</table>
			</function>
		</fcs_function>
		
		<!-- Following functions fix a FGTurbine inaccuracy... rated thrust N1% should be rated thrust lbs -->
		<!-- These calculations change it so that the rated power at sea level is at the correct N1% value. It still changes with altitude and mach as it should -->
		<fcs_function name="fadec/limit/rated-thrust-target">
			<function>
				<sum>
					<product>
						<property>propulsion/engine[0]/IdleThrust</property> <!-- It doesn't matter which engine, its same for all -->
						<property>fadec/limit/rated-thrust</property>
					</product>
					<product>
						<difference>
							<property>fadec/limit/rated-thrust</property>
							<product>
								<property>propulsion/engine[0]/IdleThrust</property> <!-- It doesn't matter which engine, its same for all -->
								<property>fadec/limit/rated-thrust</property>
							</product>
						</difference>
						<property>fadec/limit/milthrust-density</property>
					</product>
				</sum>
			</function>
		</fcs_function>
		
		<fcs_function name="fadec/limit/rated-thrust-actual">
			<function>
				<sum>
					<product>
						<property>propulsion/engine[0]/IdleThrust</property> <!-- It doesn't matter which engine, its same for all -->
						<property>fadec/limit/rated-thrust</property>
					</product>
					<product>
						<product>
							<difference>
								<property>fadec/limit/rated-thrust</property>
								<product>
									<property>propulsion/engine[0]/IdleThrust</property> <!-- It doesn't matter which engine, its same for all -->
									<property>fadec/limit/rated-thrust</property>
								</product>
							</difference>
							<property>fadec/limit/milthrust-density</property>
						</product>
						<pow>
							<quotient>
								<difference>
									<property>fadec/limit/rated-thrust-n1</property>
									<value>18.9</value>
								</difference>
								<value>85.1</value>
							</quotient>
							<value>2</value>
						</pow>
					</product>
				</sum>
			</function>
		</fcs_function>
		
		<fcs_function name="fadec/limit/rated-thrust-factor">
			<function>
				<ifthen>
					<nq> <!-- Prevent divide by 0 -->
						<property>fadec/limit/rated-thrust-actual</property>
						<value>0</value>
					</nq>
					<quotient>
						<property>fadec/limit/rated-thrust-target</property>
						<property>fadec/limit/rated-thrust-actual</property>
					</quotient>
					<value>1</value>
				</ifthen>
			</function>
		</fcs_function>
		
		<fcs_function name="fadec/limit/toga-table">
			<function>
				<table>
					<independentVar lookup="row">/position/altitude-ft</independentVar>
					<independentVar lookup="column">propulsion/tat-c</independentVar>
					<tableData>
						      -45   -35   -25   -15   -5     5     15    25    35    45    55    65    75
						-2000  74.8  76.3  77.9  79.4  80.9  82.4  83.8  85.3  86.7  88.2  88.2  86.8  85.8
						-1000  76.0  77.7  79.2  80.7  82.4  83.8  85.3  86.8  88.2  89.6  88.9  87.5  86.2
						    0  77.4  79.0  80.6  82.2  83.7  85.2  86.7  88.2  89.6  91.2  89.5  88.1  86.6
						 1000  77.9  79.7  81.2  82.9  84.4  85.9  87.4  88.8  90.3  91.2  89.6  87.9  86.7
						 2000  78.5  80.3  81.9  83.4  85.0  86.4  88.0  89.4  91.0  91.2  89.5  87.9  86.8
						 3000  79.1  80.8  82.4  84.0  85.7  87.1  88.6  90.1  91.5  91.2  89.4  87.9  86.8
						 4000  79.8  81.4  83.1  84.6  86.2  87.7  89.1  90.7  92.1  91.2  89.2  88.0  86.9
						 5000  80.5  82.1  83.7  85.3  86.8  88.4  89.7  91.3  92.7  91.1  89.0  88.0  86.9
						 6000  80.9  82.6  84.2  85.8  87.4  88.8  90.2  91.7  92.7  91.1  89.0  88.0  86.8
						 7000  81.6  83.3  84.9  86.5  88.1  89.6  91.1  92.5  92.8  90.9  89.0  88.1  87.3
						 8000  82.3  84.0  85.7  87.3  88.8  90.4  91.8  93.4  92.6  90.7  89.1  88.1  88.1
						 9000  82.7  84.4  86.0  87.7  89.2  90.8  92.3  93.8  92.5  90.7  89.2  88.3  88.3
						10000  83.0  84.7  86.4  88.1  89.6  91.3  92.7  94.1  92.3  90.7  89.4  88.4  88.4
						11000  83.6  85.4  87.0  88.7  90.3  91.8  93.4  94.2  92.3  90.7  89.5  89.5  89.5
						12000  84.2  85.9  87.7  89.3  91.0  92.5  94.0  94.2  92.2  90.7  89.7  89.7  89.7
						13000  84.6  86.3  88.1  89.7  91.4  92.9  94.4  94.0  92.2  90.7  89.8  89.8  89.8
						14000  85.0  86.8  88.5  90.1  91.7  93.4  94.8  93.9  92.2  90.8  89.9  89.9  89.9
					</tableData>
				</table>
			</function>
		</fcs_function>
		
		<fcs_function name="fadec/limit/toga">
			<function>
				<quotient>
					<integer>
						<sum>
							<product>
								<property>fadec/limit/toga-table</property>
								<value>10</value>
							</product>
							<value>0.5</value> <!-- Make it round correctly -->
						</sum>
					</integer>
					<value>10</value>
				</quotient>
			</function>
		</fcs_function>
		
		<fcs_function name="fadec/limit/toga-norm">
			<function>
				<table>
					<independentVar lookup="row">fadec/limit/toga</independentVar>
					<tableData>
						 18.9  0
						104.0  1
					</tableData>
				</table>
			</function>
		</fcs_function>
		
		<fcs_function name="fadec/limit/mct-table">
			<function>
				<table>
					<independentVar lookup="row">/position/altitude-ft</independentVar>
					<independentVar lookup="column">propulsion/tat-c</independentVar>
					<independentVar lookup="table">velocities/mach</independentVar>
					<tableData breakPoint="0.3">
						      -65   -35   -5     25    55
						    0  71.4  76.0  80.4  84.7  81.8
						 5000  74.3  79.1  83.4  85.0  83.9
						10000  78.3  83.1  87.5  86.0  86.9
						15000  80.7  85.4  89.7  85.6  89.2
					</tableData>
					<tableData breakPoint="0.4">
						      -65   -35   -5     25    55
						    0  70.9  75.4  79.8  83.9  82.0
						 5000  73.7  78.3  82.7  85.4  83.2
						10000  77.5  82.2  86.5  86.3  85.9
						15000  81.1  85.9  89.2  86.8  89.5
						20000  82.5  87.4  90.2  87.3  89.5
					</tableData>
					<tableData breakPoint="0.5">
						      -65   -35   -5     25    55
						    0  70.2  74.8  79.1  83.2  82.5
						 5000  72.8  77.6  81.9  85.9  82.6
						10000  76.7  81.3  85.8  86.8  85.1
						15000  79.3  83.9  88.2  86.3  87.6
						20000  80.3  85.2  88.4  85.3  88.9
						25000  81.8  86.5  87.4  87.1  90.8
					</tableData>
					<tableData breakPoint="0.6">
						      -65   -35   -5     25    55
						 5000  71.9  76.4  80.7  84.9  82.8
						10000  75.2  79.9  84.2  86.8  83.5
						15000  77.7  82.4  86.6  86.4  86.8
						20000  79.6  84.4  87.3  86.3  87.9
						25000  79.9  84.6  86.8  85.1  88.7
					</tableData>
					<tableData breakPoint="0.7">
						      -65   -35   -5     25    55
						15000  75.6  80.1  84.3  86.0  83.5
						20000  77.7  82.5  86.0  86.3  85.9
						25000  77.7  82.4  86.6  85.8  86.4
						35000  81.1  85.9  84.3  85.4  88.0
						39000  81.0  85.7  83.4  85.3  87.8
						45000  82.0  85.8  83.0  84.9  87.3
					</tableData>
					<tableData breakPoint="0.8">
						      -65   -35   -5     25    55
						20000  75.5  80.3  84.6  85.1  83.6
						25000  77.5  80.5  83.9  83.2  83.7
						35000  78.5  83.2  83.9  82.6  86.3
						39000  78.4  83.0  83.0  82.5  86.2
						45000  79.4  83.9  82.6  82.0  85.8
					</tableData>
				</table>
			</function>
		</fcs_function>
		
		<fcs_function name="fadec/limit/mct">
			<function>
				<quotient>
					<integer>
						<sum>
							<product>
								<property>fadec/limit/mct-table</property>
								<value>10</value>
							</product>
							<value>0.5</value> <!-- Make it round correctly -->
						</sum>
					</integer>
					<value>10</value>
				</quotient>
			</function>
		</fcs_function>
		
		<fcs_function name="fadec/limit/climb-table">
			<function>
				<table>
					<independentVar lookup="row">/position/altitude-ft</independentVar>
					<independentVar lookup="column">propulsion/tat-c</independentVar>
					<independentVar lookup="table">velocities/mach</independentVar>
					<tableData breakPoint="0.4">
						      -65   -35   -5     25    55
						 5000  69.6  74.2  78.4  81.2  79.3
						 8000  71.8  76.3  80.5  81.8  81.2
						10000  73.6  78.1  82.4  82.8  82.3
						14000  76.2  80.8  85.2  83.5  84.0
					</tableData>
					<tableData breakPoint="0.6">
						      -65   -35   -5     25    55
						 5000  67.9  72.3  76.5  80.5  78.8
						10000  71.0  75.3  79.5  82.5  80.3
						14000  72.7  77.4  81.6  82.5  81.9
						20000  76.6  81.1  85.4  83.2  84.5
						25000  78.8  83.4  85.7  84.0  85.9
					</tableData>
					<tableData breakPoint="0.8">
						      -65   -35   -5     25    55
						20000  72.5  77.1  81.2  82.3  81.3
						25000  74.0  78.6  82.8  81.2  82.6
						35000  77.5  82.0  82.8  81.4  83.5
						39000  77.4  81.9  81.9  81.4  83.4
						45000  78.3  82.8  81.0  80.9  83.2
					</tableData>
					<tableData breakPoint="0.85">
						      -65   -35   -5     25    55
						25000  73.2  77.7  81.9  81.2  81.7
						35000  76.0  81.3  82.7  80.0  81.5
						39000  75.8  81.2  81.7  79.9  81.4
						45000  77.1  81.5  81.4  79.5  81.3
					</tableData>
				</table>
			</function>
		</fcs_function>
		
		<fcs_function name="fadec/limit/climb">
			<function>
				<quotient>
					<integer>
						<sum>
							<product>
								<property>fadec/limit/climb-table</property>
								<value>10</value>
							</product>
							<value>0.5</value> <!-- Make it round correctly -->
						</sum>
					</integer>
					<value>10</value>
				</quotient>
			</function>
		</fcs_function>
		
		<fcs_function name="fadec/limit/climb-norm">
			<function>
				<table>
					<independentVar lookup="row">fadec/limit/climb</independentVar>
					<tableData>
						 18.9  0
						104.0  1
					</tableData>
				</table>
			</function>
		</fcs_function>
		
		<fcs_function name="fadec/limit/climb-norm-deadzone">
			<function>
				<sum>
					<property>fadec/limit/climb-norm</property>
					<value>0.02</value>
				</sum>
			</function>
		</fcs_function>
		
		<fcs_function name="fadec/limit/idle-table">
			<function>
				<ifthen>
					<eq>
						<property>position/wow</property>
						<value>0</value>
					</eq>
					<table>
						<independentVar lookup="row">velocities/mach</independentVar>
						<independentVar lookup="column">/controls/flight/flaps</independentVar>
						<independentVar lookup="table">/position/altitude-ft</independentVar>
						<tableData breakPoint="0">
							      0.05  0.15
							0.21  24.9  31.2
							0.70  33.1  37.9
						</tableData>
						<tableData breakPoint="45000">
							      0.05  0.15
							0.55  42.8  49.2
							0.90  48.8  51.1
						</tableData>
					</table>
					<value>0</value>
				</ifthen>
			</function>
		</fcs_function>
		
		<fcs_function name="fadec/limit/idle">
			<function>
				<quotient>
					<integer>
						<sum>
							<product>
								<property>fadec/limit/idle-table</property>
								<value>10</value>
							</product>
							<value>0.5</value> <!-- Make it round correctly -->
						</sum>
					</integer>
					<value>10</value>
				</quotient>
			</function>
		</fcs_function>
		
		<fcs_function name="fadec/limit/idle-norm">
			<function>
				<table>
					<independentVar lookup="row">fadec/limit/idle</independentVar>
					<tableData>
						 18.9  0
						104.0  1
					</tableData>
				</table>
			</function>
			<output>/it-autoflight/settings/autothrottle-min</output>
		</fcs_function>
		
		<fcs_function name="fadec/limit/mrev-table">
			<function>
				<table>
					<independentVar lookup="row">/position/altitude-ft</independentVar>
					<independentVar lookup="column">propulsion/tat-c</independentVar>
					<tableData>
						      -65   -35   -5     25    55
						    0  62.4  66.2  69.9  73.5  72.2
						10000  70.6  74.2  77.6  80.2  79.7
					</tableData>
				</table>
			</function>
		</fcs_function>
		
		<fcs_function name="fadec/limit/mrev">
			<function>
				<quotient>
					<integer>
						<sum>
							<product>
								<property>fadec/limit/mrev-table</property>
								<value>10</value>
							</product>
							<value>0.5</value> <!-- Make it round correctly -->
						</sum>
					</integer>
					<value>10</value>
				</quotient>
			</function>
		</fcs_function>
		
		<fcs_function name="fadec/limit/mrev-norm">
			<function>
				<table>
					<independentVar lookup="row">fadec/limit/mrev</independentVar>
					<tableData>
						 18.9  0
						104.0  1
					</tableData>
				</table>
			</function>
		</fcs_function>
		
		<switch name="fadec/limit/climb-latch">
			<default value="fadec/limit/climb-latch"/>
			<test value="0">
				/it-autoflight/output/vert eq 8
			</test>
			<test value="1">
				/it-autoflight/output/vert ne 7
			</test>
			<test logic="AND" value="0">
				/it-autoflight/output/vert eq 7
				position/wow eq 1
			</test>
			<test logic="AND" value="1">
				/it-autoflight/output/vert eq 7
				/position/gear-agl-ft ge 1500
			</test>
		</switch>
		
		<switch name="fadec/limit/active-int">
			<default value="0"/> <!-- Takeoff/Go Around -->
			<test logic="AND" value="2"> <!-- Climb -->
				fadec/limit/climb-latch eq 1
				/engines/engine[0]/running eq 1
				/engines/engine[1]/running eq 1
				/engines/engine[2]/running eq 1
				/engines/engine[3]/running eq 1
			</test>
			<test value="1"> <!-- Max Continuous -->
				fadec/limit/climb-latch eq 1
			</test>
		</switch>
		
		<switch name="fadec/limit/active">
			<default value="fadec/limit/toga"/>
			<test value="fadec/limit/mct">
				fadec/limit/active-int eq 1
			</test>
			<test value="fadec/limit/climb">
				fadec/limit/active-int eq 2
			</test>
		</switch>
		
		<fcs_function name="fadec/limit/active-norm">
			<function>
				<table>
					<independentVar lookup="row">fadec/limit/active</independentVar>
					<tableData>
						 18.9  0
						104.0  1
					</tableData>
				</table>
			</function>
			<output>/it-autoflight/settings/autothrottle-max</output>
		</fcs_function>
	
	</channel>
	
	<channel name="Engine Control">
		
		<!-- Engine 1 -->
		<switch name="fadec/control-1/throttle-pos">
			<default value="/controls/engines/engine[0]/throttle"/>
			<test value="0">
				/engines/engine[0]/reverser-pos-norm ne 0
			</test>
		</switch>
		
		<lag_filter name="fadec/control-1/throttle-lag">
			<input>fadec/control-1/throttle-pos</input>
			<c1>20</c1>
		</lag_filter>
		
		<pure_gain name="fadec/control-1/throttle-cmd">
			<input>fadec/control-1/throttle-pos</input>
			<gain>1.0</gain>
			<clipto>
				<min>fadec/limit/idle-norm</min>
				<max>fadec/limit/toga-norm</max>
			</clipto>
		</pure_gain>
		
		<switch name="fadec/control-1/throttle-pos-rev">
			<default value="0"/>
			<test value="/controls/engines/engine[0]/throttle">
				/engines/engine[0]/reverser-pos-norm ne 0
			</test>
		</switch>
		
		<lag_filter name="fadec/control-1/throttle-lag-rev">
			<input>fadec/control-1/throttle-pos-rev</input>
			<c1>20</c1>
		</lag_filter>
		
		<pure_gain name="fadec/control-1/throttle-cmd-rev">
			<input>fadec/control-1/throttle-pos-rev</input>
			<gain>fadec/limit/mrev-norm</gain>
			<clipto>
				<min>0.08</min>
				<max>fadec/limit/mrev-norm</max>
			</clipto>
		</pure_gain>
		
		<switch name="fadec/control-1/throttle-output">
			<default value="fadec/control-1/throttle-cmd"/>
			<test value="fadec/control-1/throttle-cmd-rev">
				/engines/engine[0]/reverser-pos-norm ne 0
			</test>
		</switch>
		
		<lag_filter name="fadec/control-1/throttle-fdm">
			<input>fadec/control-1/throttle-output</input>
			<c1>0.75</c1>
			<output>fcs/throttle-pos-norm[0]</output>
		</lag_filter>
		
		<!-- Engine 2 -->
		<switch name="fadec/control-2/throttle-pos">
			<default value="/controls/engines/engine[1]/throttle"/>
			<test value="0">
				/engines/engine[1]/reverser-pos-norm ne 0
			</test>
		</switch>
		
		<lag_filter name="fadec/control-2/throttle-lag">
			<input>fadec/control-2/throttle-pos</input>
			<c1>20</c1>
		</lag_filter>
		
		<pure_gain name="fadec/control-2/throttle-cmd">
			<input>fadec/control-2/throttle-pos</input>
			<gain>1.0</gain>
			<clipto>
				<min>fadec/limit/idle-norm</min>
				<max>fadec/limit/toga-norm</max>
			</clipto>
		</pure_gain>
		
		<switch name="fadec/control-2/throttle-pos-rev">
			<default value="0"/>
			<test value="/controls/engines/engine[1]/throttle">
				/engines/engine[1]/reverser-pos-norm ne 0
			</test>
		</switch>
		
		<lag_filter name="fadec/control-2/throttle-lag-rev">
			<input>fadec/control-2/throttle-pos-rev</input>
			<c1>20</c1>
		</lag_filter>
		
		<pure_gain name="fadec/control-2/throttle-cmd-rev">
			<input>fadec/control-2/throttle-pos-rev</input>
			<gain>fadec/limit/mrev-norm</gain>
			<clipto>
				<min>0.08</min>
				<max>fadec/limit/mrev-norm</max>
			</clipto>
		</pure_gain>
		
		<switch name="fadec/control-2/throttle-output">
			<default value="fadec/control-2/throttle-cmd"/>
			<test value="fadec/control-2/throttle-cmd-rev">
				/engines/engine[1]/reverser-pos-norm ne 0
			</test>
		</switch>
		
		<lag_filter name="fadec/control-2/throttle-fdm">
			<input>fadec/control-2/throttle-output</input>
			<c1>0.75</c1>
			<output>fcs/throttle-pos-norm[1]</output>
		</lag_filter>
		
		<!-- Engine 3 -->
		<switch name="fadec/control-3/throttle-pos">
			<default value="/controls/engines/engine[2]/throttle"/>
			<test value="0">
				/engines/engine[2]/reverser-pos-norm ne 0
			</test>
		</switch>
		
		<lag_filter name="fadec/control-3/throttle-lag">
			<input>fadec/control-3/throttle-pos</input>
			<c1>20</c1>
		</lag_filter>
		
		<pure_gain name="fadec/control-3/throttle-cmd">
			<input>fadec/control-3/throttle-pos</input>
			<gain>1.0</gain>
			<clipto>
				<min>fadec/limit/idle-norm</min>
				<max>fadec/limit/toga-norm</max>
			</clipto>
		</pure_gain>
		
		<switch name="fadec/control-3/throttle-pos-rev">
			<default value="0"/>
			<test value="/controls/engines/engine[2]/throttle">
				/engines/engine[2]/reverser-pos-norm ne 0
			</test>
		</switch>
		
		<lag_filter name="fadec/control-3/throttle-lag-rev">
			<input>fadec/control-3/throttle-pos-rev</input>
			<c1>20</c1>
		</lag_filter>
		
		<pure_gain name="fadec/control-3/throttle-cmd-rev">
			<input>fadec/control-3/throttle-pos-rev</input>
			<gain>fadec/limit/mrev-norm</gain>
			<clipto>
				<min>0.08</min>
				<max>fadec/limit/mrev-norm</max>
			</clipto>
		</pure_gain>
		
		<switch name="fadec/control-3/throttle-output">
			<default value="fadec/control-3/throttle-cmd"/>
			<test value="fadec/control-3/throttle-cmd-rev">
				/engines/engine[2]/reverser-pos-norm ne 0
			</test>
		</switch>
		
		<lag_filter name="fadec/control-3/throttle-fdm">
			<input>fadec/control-3/throttle-output</input>
			<c1>0.75</c1>
			<output>fcs/throttle-pos-norm[2]</output>
		</lag_filter>
		
		<!-- Engine 4 -->
		<switch name="fadec/control-4/throttle-pos">
			<default value="/controls/engines/engine[3]/throttle"/>
			<test value="0">
				/engines/engine[3]/reverser-pos-norm ne 0
			</test>
		</switch>
		
		<lag_filter name="fadec/control-4/throttle-lag">
			<input>fadec/control-4/throttle-pos</input>
			<c1>20</c1>
		</lag_filter>
		
		<pure_gain name="fadec/control-4/throttle-cmd">
			<input>fadec/control-4/throttle-pos</input>
			<gain>1.0</gain>
			<clipto>
				<min>fadec/limit/idle-norm</min>
				<max>fadec/limit/toga-norm</max>
			</clipto>
		</pure_gain>
		
		<switch name="fadec/control-4/throttle-pos-rev">
			<default value="0"/>
			<test value="/controls/engines/engine[3]/throttle">
				/engines/engine[3]/reverser-pos-norm ne 0
			</test>
		</switch>
		
		<lag_filter name="fadec/control-4/throttle-lag-rev">
			<input>fadec/control-4/throttle-pos-rev</input>
			<c1>20</c1>
		</lag_filter>
		
		<pure_gain name="fadec/control-4/throttle-cmd-rev">
			<input>fadec/control-4/throttle-pos-rev</input>
			<gain>fadec/limit/mrev-norm</gain>
			<clipto>
				<min>0.08</min>
				<max>fadec/limit/mrev-norm</max>
			</clipto>
		</pure_gain>
		
		<switch name="fadec/control-4/throttle-output">
			<default value="fadec/control-4/throttle-cmd"/>
			<test value="fadec/control-4/throttle-cmd-rev">
				/engines/engine[3]/reverser-pos-norm ne 0
			</test>
		</switch>
		
		<lag_filter name="fadec/control-4/throttle-fdm">
			<input>fadec/control-4/throttle-output</input>
			<c1>0.75</c1>
			<output>fcs/throttle-pos-norm[3]</output>
		</lag_filter>
	
	</channel>
	
	<channel name="Engine Parameters">
		
		<lag_filter name="fadec/n1-actual-1">
			<input>/engines/engine[0]/n1</input>
			<c1>2.25</c1>
			<output>/engines/engine[0]/n1-actual</output>
			<output>/engines/engine[4]/n1</output>
		</lag_filter>
		
		<lag_filter name="fadec/n1-actual-2">
			<input>/engines/engine[1]/n1</input>
			<c1>2.25</c1>
			<output>/engines/engine[1]/n1-actual</output>
			<output>/engines/engine[5]/n1</output>
		</lag_filter>
		
		<lag_filter name="fadec/n1-actual-3">
			<input>/engines/engine[2]/n1</input>
			<c1>2.25</c1>
			<output>/engines/engine[2]/n1-actual</output>
			<output>/engines/engine[6]/n1</output>
		</lag_filter>
		
		<lag_filter name="fadec/n1-actual-4">
			<input>/engines/engine[3]/n1</input>
			<c1>2.25</c1>
			<output>/engines/engine[3]/n1-actual</output>
			<output>/engines/engine[7]/n1</output>
		</lag_filter>
		
		<lag_filter name="fadec/n2-actual-1">
			<input>/engines/engine[0]/n2</input>
			<c1>2.25</c1>
			<output>/engines/engine[0]/n2-actual</output>
			<output>/engines/engine[4]/n2</output>
		</lag_filter>
		
		<lag_filter name="fadec/n2-actual-2">
			<input>/engines/engine[1]/n2</input>
			<c1>2.25</c1>
			<output>/engines/engine[1]/n2-actual</output>
			<output>/engines/engine[5]/n2</output>
		</lag_filter>
		
		<lag_filter name="fadec/n2-actual-3">
			<input>/engines/engine[2]/n2</input>
			<c1>2.25</c1>
			<output>/engines/engine[2]/n2-actual</output>
			<output>/engines/engine[6]/n2</output>
		</lag_filter>
		
		<lag_filter name="fadec/n2-actual-4">
			<input>/engines/engine[3]/n2</input>
			<c1>2.25</c1>
			<output>/engines/engine[3]/n2-actual</output>
			<output>/engines/engine[7]/n2</output>
		</lag_filter>
		
		<lag_filter name="fadec/ff-actual-1">
			<input>/engines/engine[0]/fuel-flow_pph</input>
			<c1>3.0</c1>
			<output>/engines/engine[0]/ff-actual</output>
		</lag_filter>
		
		<lag_filter name="fadec/ff-actual-2">
			<input>/engines/engine[1]/fuel-flow_pph</input>
			<c1>3.0</c1>
			<output>/engines/engine[1]/ff-actual</output>
		</lag_filter>
		
		<lag_filter name="fadec/ff-actual-3">
			<input>/engines/engine[2]/fuel-flow_pph</input>
			<c1>3.0</c1>
			<output>/engines/engine[2]/ff-actual</output>
		</lag_filter>
		
		<lag_filter name="fadec/ff-actual-4">
			<input>/engines/engine[3]/fuel-flow_pph</input>
			<c1>3.0</c1>
			<output>/engines/engine[3]/ff-actual</output>
		</lag_filter>
	
	</channel>

</system>
